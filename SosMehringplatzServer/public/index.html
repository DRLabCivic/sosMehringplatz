<!doctype html>
<html>
	<head>
	<title>Test Client</title>
	<script src="libs/socket.io.js"></script>
	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script>
		var socket = io();


		var addSubmission = function(submission) {
			console.log(submission);
			$('#messages').append('<li>'+submission._id+':'+submission.content+'</li>');
		};

		socket.on('connect', function() {
			console.log('socket connected');

			//get initial list
			socket.emit('submissions:list'); 
		});

		socket.on('submissions:new', function(res) {
			addSubmission(res.data);
		});

		// only load the initial list once
		socket.once('submissions:list', function(res) {
			res.data.forEach( function(elem) {
				addSubmission(elem);
			});
		});
		


	</script>
	</head>
	<body>
		<h1>Messages</h1>
		<ul id="messages"></ul>
	</body>
</html>